{
  "metrics": {
    "enabled": true,
    "path": "/metrics",
    "decision_log_sample_rate": 0.01,
    "rollup_interval_secs": 60
  },
  "carbon": {
    "provider": "mock",
    "cache_ttl_minutes": 1,
    "provider_timeout_ms": 75,
    "electricitymap_base_url": "https://api.electricitymap.org",
    "electricitymap_api_key": null,
    "electricitymap_api_token_header": "auth-token",
    "electricitymap_zone_map": {},
    "electricitymap_disable_estimations": false,
    "default_carbon_intensity": 420,
    "zone_current": {
      "us-east": 430,
      "us-west": 300
    },
    "zone_forecast_next": {
      "us-east": 370,
      "us-west": 290
    }
  },
  "proxies": [
    {
      "app_name": "edge-router-demo",
      "app_uri": "http://us-east:5678",
      "rewrite": "none",
      "rule": {
        "path": "/",
        "type": "contain"
      },
      "zones": [
        {
          "name": "us-east",
          "region": "us-east",
          "app_uri": "http://us-east:5678",
          "base_rtt_ms": 24,
          "cost_weight": 0.25,
          "max_in_flight": 200,
          "tags": ["us", "tier-1"]
        },
        {
          "name": "us-west",
          "region": "us-west",
          "app_uri": "http://us-west:5678",
          "base_rtt_ms": 36,
          "cost_weight": 0.2,
          "max_in_flight": 200,
          "tags": ["us", "green"]
        }
      ],
      "policy": {
        "carbon_cursor_enabled": true,
        "route_class": "flexible",
        "priority_mode": "balanced",
        "constraints": {
          "max_candidates": 8,
          "zone_allowlist": [],
          "max_added_latency_ms": 50,
          "p95_latency_budget_ms": 220,
          "max_error_rate": 0.05
        },
        "weights": {
          "w_carbon": 0.55,
          "w_latency": 0.3,
          "w_errors": 0.15,
          "w_cost": 0.0
        },
        "forecasting_enabled": true,
        "time_shift_enabled": true,
        "forecast_window_minutes": 30,
        "forecast_min_improvement_ratio": 0.1,
        "max_defer_seconds": 0,
        "fail_safe_lowest_latency": true,
        "hysteresis_delta": 0.04,
        "min_switch_interval_secs": 20,
        "plugin_enabled": true,
        "plugin_timeout_ms": 25
      }
    }
  ]
}
