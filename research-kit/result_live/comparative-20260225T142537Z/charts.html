<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rilot Experiment Charts</title>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    :root {
      --bg: #f7f4ee;
      --ink: #12202a;
      --muted: #4d5b65;
      --card: #ffffff;
      --accent: #1f7a8c;
      --accent2: #bf4342;
      --grid: #dde4e8;
    }
    body {
      margin: 0;
      font-family: "IBM Plex Sans", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #fefbf4, var(--bg));
      color: var(--ink);
    }
    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .top {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .badge {
      background: var(--card);
      border: 1px solid #d4dde3;
      border-radius: 8px;
      padding: 8px 10px;
      font-size: 13px;
      color: var(--muted);
    }
    h1 {
      margin: 0 0 10px;
      font-size: 24px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    .card {
      background: var(--card);
      border: 1px solid #d4dde3;
      border-radius: 12px;
      padding: 14px 16px;
    }
    .card h3 {
      margin: 2px 0 10px;
      font-size: 18px;
    }
    svg {
      width: 100%;
      height: 360px;
      display: block;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    th, td {
      padding: 6px 7px;
      border-bottom: 1px solid #e5ecef;
      text-align: left;
    }
    th {
      color: var(--muted);
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Rilot Comparative Dashboard</h1>
    <div class="top">
      <div class="badge">Input: <code>/Users/sudodevstudio/devStudio/rilot/research-kit/result_live/comparative-20260225T142537Z</code></div>
      <div class="badge">Generated: 2026-02-25T19:15:08.893Z</div>
      <div class="badge">Scenarios: 6</div>
      <div class="badge">Requests: 60</div>
    </div>

    <div class="grid">
      <div class="card"><h3>Mean Carbon Exposure (gCO2/kWh)</h3><svg id="carbon"></svg></div>
      <div class="card"><h3>P95 Latency (ms)</h3><svg id="latency"></svg></div>
      <div class="card"><h3>Cross-Region Reroutes</h3><svg id="reroutes"></svg></div>
      <div class="card"><h3>Selected Zone Region Mix</h3><svg id="zones"></svg></div>
    </div>

    <div class="card" style="margin-top:14px;">
      <h3>Scenario Table</h3>
      <table id="summaryTable"></table>
    </div>
  </div>

  <script>
    const summary = [{"scenario":"baseline_no_carbon_balanced","kind":"rilot_mode","requests":10,"ok_count":"9","error_count":"1","error_rate_percent":10,"latency_avg_ms":"71.1415917146951","latency_p95_ms":82.75312487967312,"latency_p95_delta_ms_vs_baseline":"0.0","cpu_percent_sample":"2.9885810504331154","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"0.0","memory_mb_sample":"7.23046875","memory_current_mb_sample":"3.94140625","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"0.0","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":435,"carbon_exposure_saved_g_per_kwh_vs_baseline":"0.0","carbon_exposure_saved_percent_vs_baseline":0,"co2e_estimated_total_g":"0.00025016000000000003","co2e_saved_g_vs_baseline":"0.0","co2e_saved_percent_vs_baseline":"0.0"},{"scenario":"baseline_no_carbon_latency_first","kind":"rilot_mode","requests":10,"ok_count":"10","error_count":"0","error_rate_percent":0,"latency_avg_ms":"72.53275397233665","latency_p95_ms":86.0444160643965,"latency_p95_delta_ms_vs_baseline":"3.2912911847233772","cpu_percent_sample":"2.866797425852349","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"-0.12178362458076641","memory_mb_sample":"6.9453125","memory_current_mb_sample":"4.734375","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"-0.28515625","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":435,"carbon_exposure_saved_g_per_kwh_vs_baseline":"0.0","carbon_exposure_saved_percent_vs_baseline":0,"co2e_estimated_total_g":"0.00025431","co2e_saved_g_vs_baseline":"-4.149999999999965e-06","co2e_saved_percent_vs_baseline":"-1.6589382795011054"},{"scenario":"baseline_no_carbon_strict_local","kind":"rilot_mode","requests":10,"ok_count":"10","error_count":"0","error_rate_percent":0,"latency_avg_ms":"71.64647066965699","latency_p95_ms":86.80958300828934,"latency_p95_delta_ms_vs_baseline":"4.056458128616214","cpu_percent_sample":"2.8303303169620033","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"-0.15825073347111207","memory_mb_sample":"6.14453125","memory_current_mb_sample":"3.96484375","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"-1.0859375","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":435,"carbon_exposure_saved_g_per_kwh_vs_baseline":"0.0","carbon_exposure_saved_percent_vs_baseline":0,"co2e_estimated_total_g":"0.00025229","co2e_saved_g_vs_baseline":"-2.1299999999999813e-06","co2e_saved_percent_vs_baseline":"-0.8514550687559885"},{"scenario":"latency_first","kind":"rilot_mode","requests":10,"ok_count":"10","error_count":"0","error_rate_percent":0,"latency_avg_ms":"74.31277502328157","latency_p95_ms":85.03933297470212,"latency_p95_delta_ms_vs_baseline":"2.2862080950289965","cpu_percent_sample":"2.7805244373096714","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"-0.20805661312344403","memory_mb_sample":"6.72265625","memory_current_mb_sample":"4.67578125","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"-0.5078125","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":373,"carbon_exposure_saved_g_per_kwh_vs_baseline":"62.0","carbon_exposure_saved_percent_vs_baseline":14.25287356321839,"co2e_estimated_total_g":"0.00022517000000000001","co2e_saved_g_vs_baseline":"2.4990000000000017e-05","co2e_saved_percent_vs_baseline":"9.98960665174289"},{"scenario":"carbon_first","kind":"rilot_mode","requests":10,"ok_count":"10","error_count":"0","error_rate_percent":0,"latency_avg_ms":"77.20937917474657","latency_p95_ms":88.25208293274045,"latency_p95_delta_ms_vs_baseline":"5.4989580530673265","cpu_percent_sample":"2.7514872330866296","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"-0.23709381734648582","memory_mb_sample":"8.03515625","memory_current_mb_sample":"4.2734375","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"0.8046875","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":339,"carbon_exposure_saved_g_per_kwh_vs_baseline":"96.0","carbon_exposure_saved_percent_vs_baseline":22.06896551724138,"co2e_estimated_total_g":"0.00021303","co2e_saved_g_vs_baseline":"3.713000000000002e-05","co2e_saved_percent_vs_baseline":"14.842500799488334"},{"scenario":"balanced","kind":"rilot_mode","requests":10,"ok_count":"9","error_count":"1","error_rate_percent":10,"latency_avg_ms":"76.6443959902972","latency_p95_ms":84.75266699679196,"latency_p95_delta_ms_vs_baseline":"1.9995421171188354","cpu_percent_sample":"2.5761284599967307","cpu_sample_method":"cgroup_delta","cpu_delta_percent_vs_baseline":"-0.4124525904363847","memory_mb_sample":"6.53515625","memory_current_mb_sample":"4.5546875","memory_peak_delta_mb":"0.0","memory_delta_mb_vs_baseline":"-0.6953125","cross_region_reroutes":0,"east_to_west_reroutes":"0","west_to_east_reroutes":"0","carbon_exposure_mean_g_per_kwh":366,"carbon_exposure_saved_g_per_kwh_vs_baseline":"69.0","carbon_exposure_saved_percent_vs_baseline":15.862068965517242,"co2e_estimated_total_g":"0.00022831000000000001","co2e_saved_g_vs_baseline":"2.1850000000000016e-05","co2e_saved_percent_vs_baseline":"8.734409977614332"}];
    const requests = [{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"65.096","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"59.192","http_code":"599","selected_zone":"","selected_carbon_intensity_g_per_kwh":"","carbon_saved_vs_worst_g_per_kwh":"","carbon_saved_vs_worst_percent":"","decision_reason":""},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"60.489","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"61.943","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"63.441","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"79.944","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.949","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:41Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"77.044","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:42Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.564","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:42Z","scenario":"baseline_no_carbon_balanced","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"82.753","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:45Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"68.537","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:45Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"61.342","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"59.035","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"63.308","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"68.243","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"77.252","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"86.044","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"83.793","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"79.622","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:46Z","scenario":"baseline_no_carbon_latency_first","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"78.151","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"67.462","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"67.557","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"61.380","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"62.565","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"61.942","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.107","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"86.810","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"75.132","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"74.795","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:50Z","scenario":"baseline_no_carbon_strict_local","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"78.714","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"fallback-lowest-latency"},{"timestamp_utc":"2026-02-25T14:25:54Z","scenario":"latency_first","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"69.715","http_code":"200","selected_zone":"zone-10","selected_carbon_intensity_g_per_kwh":"280.000","carbon_saved_vs_worst_g_per_kwh":"200.000","carbon_saved_vs_worst_percent":"41.67","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:54Z","scenario":"latency_first","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"66.559","http_code":"200","selected_zone":"zone-07","selected_carbon_intensity_g_per_kwh":"340.000","carbon_saved_vs_worst_g_per_kwh":"140.000","carbon_saved_vs_worst_percent":"29.17","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:54Z","scenario":"latency_first","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"63.697","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:54Z","scenario":"latency_first","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"65.131","http_code":"200","selected_zone":"zone-02","selected_carbon_intensity_g_per_kwh":"460.000","carbon_saved_vs_worst_g_per_kwh":"20.000","carbon_saved_vs_worst_percent":"4.17","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"71.520","http_code":"200","selected_zone":"zone-03","selected_carbon_intensity_g_per_kwh":"430.000","carbon_saved_vs_worst_g_per_kwh":"50.000","carbon_saved_vs_worst_percent":"10.42","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"85.039","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.863","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"82.566","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"75.044","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:55Z","scenario":"latency_first","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"82.993","http_code":"200","selected_zone":"zone-06","selected_carbon_intensity_g_per_kwh":"360.000","carbon_saved_vs_worst_g_per_kwh":"120.000","carbon_saved_vs_worst_percent":"25.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"68.607","http_code":"200","selected_zone":"zone-10","selected_carbon_intensity_g_per_kwh":"280.000","carbon_saved_vs_worst_g_per_kwh":"200.000","carbon_saved_vs_worst_percent":"41.67","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"71.054","http_code":"200","selected_zone":"zone-07","selected_carbon_intensity_g_per_kwh":"340.000","carbon_saved_vs_worst_g_per_kwh":"140.000","carbon_saved_vs_worst_percent":"29.17","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"88.252","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.734","http_code":"200","selected_zone":"zone-08","selected_carbon_intensity_g_per_kwh":"320.000","carbon_saved_vs_worst_g_per_kwh":"160.000","carbon_saved_vs_worst_percent":"33.33","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"63.325","http_code":"200","selected_zone":"zone-02","selected_carbon_intensity_g_per_kwh":"460.000","carbon_saved_vs_worst_g_per_kwh":"20.000","carbon_saved_vs_worst_percent":"4.17","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"84.113","http_code":"200","selected_zone":"zone-06","selected_carbon_intensity_g_per_kwh":"360.000","carbon_saved_vs_worst_g_per_kwh":"120.000","carbon_saved_vs_worst_percent":"25.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"86.194","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"67.521","http_code":"200","selected_zone":"zone-10","selected_carbon_intensity_g_per_kwh":"280.000","carbon_saved_vs_worst_g_per_kwh":"200.000","carbon_saved_vs_worst_percent":"41.67","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"81.858","http_code":"200","selected_zone":"zone-06","selected_carbon_intensity_g_per_kwh":"360.000","carbon_saved_vs_worst_g_per_kwh":"120.000","carbon_saved_vs_worst_percent":"25.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:25:59Z","scenario":"carbon_first","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.436","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:03Z","scenario":"balanced","request_id":"req-000001","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"73.193","http_code":"200","selected_zone":"zone-10","selected_carbon_intensity_g_per_kwh":"280.000","carbon_saved_vs_worst_g_per_kwh":"200.000","carbon_saved_vs_worst_percent":"41.67","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:03Z","scenario":"balanced","request_id":"req-000002","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"68.538","http_code":"599","selected_zone":"","selected_carbon_intensity_g_per_kwh":"","carbon_saved_vs_worst_g_per_kwh":"","carbon_saved_vs_worst_percent":"","decision_reason":""},{"timestamp_utc":"2026-02-25T14:26:03Z","scenario":"balanced","request_id":"req-000003","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"67.006","http_code":"200","selected_zone":"zone-02","selected_carbon_intensity_g_per_kwh":"460.000","carbon_saved_vs_worst_g_per_kwh":"20.000","carbon_saved_vs_worst_percent":"4.17","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:03Z","scenario":"balanced","request_id":"req-000004","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"65.254","http_code":"200","selected_zone":"zone-01","selected_carbon_intensity_g_per_kwh":"480.000","carbon_saved_vs_worst_g_per_kwh":"0.000","carbon_saved_vs_worst_percent":"0.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:03Z","scenario":"balanced","request_id":"req-000005","request_region":"us-east","routing_input_region":"us-east","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"75.493","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:04Z","scenario":"balanced","request_id":"req-000006","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"84.274","http_code":"200","selected_zone":"zone-06","selected_carbon_intensity_g_per_kwh":"360.000","carbon_saved_vs_worst_g_per_kwh":"120.000","carbon_saved_vs_worst_percent":"25.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:04Z","scenario":"balanced","request_id":"req-000007","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"83.159","http_code":"200","selected_zone":"zone-09","selected_carbon_intensity_g_per_kwh":"300.000","carbon_saved_vs_worst_g_per_kwh":"180.000","carbon_saved_vs_worst_percent":"37.50","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:04Z","scenario":"balanced","request_id":"req-000008","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"84.753","http_code":"200","selected_zone":"zone-06","selected_carbon_intensity_g_per_kwh":"360.000","carbon_saved_vs_worst_g_per_kwh":"120.000","carbon_saved_vs_worst_percent":"25.00","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:04Z","scenario":"balanced","request_id":"req-000009","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"84.327","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"score-win"},{"timestamp_utc":"2026-02-25T14:26:04Z","scenario":"balanced","request_id":"req-000010","request_region":"us-west","routing_input_region":"us-west","selected_zone_region":"","route_relation":"unknown","cross_region_reroute":"false","latency_ms":"80.448","http_code":"200","selected_zone":"zone-05","selected_carbon_intensity_g_per_kwh":"390.000","carbon_saved_vs_worst_g_per_kwh":"90.000","carbon_saved_vs_worst_percent":"18.75","decision_reason":"score-win"}];

    function drawBar(opts) {
      const { id, data, key, color, yLabel } = opts;
      const svg = d3.select(id);
      svg.selectAll("*").remove();
      const w = svg.node().clientWidth || 500;
      const h = svg.node().clientHeight || 300;
      const m = { t: 26, r: 20, b: 110, l: 64 };
      const iw = w - m.l - m.r;
      const ih = h - m.t - m.b;
      const g = svg.append("g").attr("transform", "translate(" + m.l + "," + m.t + ")");

      const x = d3.scaleBand()
        .domain(data.map(d => d.scenario))
        .range([0, iw])
        .padding(0.2);
      const maxY = d3.max(data, d => Number(d[key]) || 0) || 1;
      const y = d3.scaleLinear().domain([0, maxY]).nice().range([ih, 0]);

      g.append("g")
        .attr("transform", "translate(0," + ih + ")")
        .call(d3.axisBottom(x))
        .selectAll("text")
        .attr("transform", "rotate(-22)")
        .style("text-anchor", "end");

      g.append("g").call(d3.axisLeft(y));
      g.append("g")
        .attr("transform", "translate(-48," + (ih / 2) + ") rotate(-90)")
        .append("text")
        .style("fill", "#4d5b65")
        .style("font-size", "13px")
        .text(yLabel);

      const bars = g.selectAll("rect")
        .data(data)
        .enter()
        .append("rect")
        .attr("x", d => x(d.scenario))
        .attr("y", d => y(Number(d[key]) || 0))
        .attr("width", x.bandwidth())
        .attr("height", d => ih - y(Number(d[key]) || 0))
        .attr("fill", color);

      g.selectAll(".bar-label")
        .data(data)
        .enter()
        .append("text")
        .attr("class", "bar-label")
        .attr("x", d => (x(d.scenario) || 0) + x.bandwidth() / 2)
        .attr("y", d => y(Number(d[key]) || 0) - 6)
        .attr("text-anchor", "middle")
        .style("font-size", "11px")
        .style("fill", "#21323e")
        .text(d => {
          const v = Number(d[key]) || 0;
          if (Math.abs(v) >= 100) return v.toFixed(0);
          if (Math.abs(v) >= 10) return v.toFixed(1);
          return v.toFixed(2);
        });
    }

    function drawZones() {
      const svg = d3.select("#zones");
      svg.selectAll("*").remove();
      const w = svg.node().clientWidth || 500;
      const h = svg.node().clientHeight || 300;
      const m = { t: 24, r: 20, b: 52, l: 64 };
      const iw = w - m.l - m.r;
      const ih = h - m.t - m.b;
      const g = svg.append("g").attr("transform", "translate(" + m.l + "," + m.t + ")");

      const counts = d3.rollup(
        requests.filter(r => r.selected_zone_region),
        v => v.length,
        d => d.selected_zone_region
      );
      const data = Array.from(counts, ([region, count]) => ({ region, count }))
        .sort((a, b) => d3.descending(a.count, b.count));
      const x = d3.scaleBand().domain(data.map(d => d.region)).range([0, iw]).padding(0.25);
      const y = d3.scaleLinear().domain([0, d3.max(data, d => d.count) || 1]).nice().range([ih, 0]);
      g.append("g").attr("transform", "translate(0," + ih + ")").call(d3.axisBottom(x));
      g.append("g").call(d3.axisLeft(y));
      g.selectAll("rect").data(data).enter().append("rect")
        .attr("x", d => x(d.region)).attr("y", d => y(d.count))
        .attr("width", x.bandwidth()).attr("height", d => ih - y(d.count))
        .attr("fill", "#355070");

      g.selectAll(".zone-label")
        .data(data)
        .enter()
        .append("text")
        .attr("class", "zone-label")
        .attr("x", d => (x(d.region) || 0) + x.bandwidth() / 2)
        .attr("y", d => y(d.count) - 6)
        .attr("text-anchor", "middle")
        .style("font-size", "11px")
        .style("fill", "#21323e")
        .text(d => d.count);
    }

    function renderTable() {
      const cols = [
        "scenario",
        "requests",
        "error_rate_percent",
        "latency_p95_ms",
        "cross_region_reroutes",
        "carbon_exposure_mean_g_per_kwh",
        "carbon_exposure_saved_percent_vs_baseline"
      ];
      const t = d3.select("#summaryTable");
      const thead = t.append("thead").append("tr");
      cols.forEach(c => thead.append("th").text(c));
      const tbody = t.append("tbody");
      summary.forEach(row => {
        const tr = tbody.append("tr");
        cols.forEach(c => tr.append("td").text(row[c] ?? ""));
      });
    }

    drawBar({
      id: "#carbon",
      data: summary,
      key: "carbon_exposure_mean_g_per_kwh",
      color: "#1f7a8c",
      yLabel: "gCO2/kWh"
    });
    drawBar({
      id: "#latency",
      data: summary,
      key: "latency_p95_ms",
      color: "#6d597a",
      yLabel: "ms"
    });
    drawBar({
      id: "#reroutes",
      data: summary,
      key: "cross_region_reroutes",
      color: "#bf4342",
      yLabel: "count"
    });
    drawZones();
    renderTable();
  </script>
</body>
</html>